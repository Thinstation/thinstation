#!/bin/sh

INSTALLDIR=./packages/xfwm4
EXTRADIR=$INSTALLDIR/build/extra
TMPDIR=./build-xfwm

for i in perl p5-xml-parser openssh dbus-glib exo freetype garcon \
gdk-pixbuf glade3 glib gtk-xfce-engine xorg-libxi xorg-libxcursor \
libexif libjpeg libnotify libpng libwnck libxfce4ui libxfce4util p5-uri startup-notification terminal thunar tumbler \
vte xdg-user-dirs xfce-utils libglade xfce4 xfce4-appfinder xfce4-dev-tools xfce4-panel xfce4-session \
xfce4-settings xfconf xfdesktop xfwm4 xorg-iceauth xorg-xinit xorg-xrdb xscreensaver ; do
	repackage $i -t $TMPDIR
	cp -Prf $TMPDIR/$i/* $INSTALLDIR/.
	rm -rf $TMPDIR
done
for theme in `ls -A --color=never $INSTALLDIR/lib/themes`; do
	if [ "$theme" != "Default" ]; then
		rm -rf $INSTALLDIR/lib/themes/$theme
	fi
done
for bloat in backdrops session xfwm4 dev-tools; do
	rm -rf $INSTALLDIR/lib/xfce4/$bloat
done
cp -Prf $EXTRADIR/* $INSTALLDIR/.

returnval=$?

exit $returnval
